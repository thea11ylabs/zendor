@import "tailwindcss";
@import "tw-animate-css";
@import "./pdfjs-viewer.css";

@custom-variant dark (&:is(.dark *));
@plugin "@tailwindcss/typography";

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

body {
  font-family: var(--font-sans), Arial, Helvetica, sans-serif;
}

/* Scrollbar styles */
.scrollbar-thin {
  scrollbar-width: thin;
}

.scrollbar-thin::-webkit-scrollbar {
  height: 6px;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: transparent;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: #d4d4d8;
  border-radius: 3px;
}

.dark .scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: #52525b;
}

/* CodeMirror overrides */
.cm-editor {
  height: 100%;
}

.cm-editor.cm-focused {
  outline: none;
}

/* TipTap Visual Editor Styles */
.ProseMirror {
  min-height: 100%;
  outline: none;
}

.ProseMirror p.is-editor-empty:first-child::before {
  content: attr(data-placeholder);
  float: left;
  color: #adb5bd;
  pointer-events: none;
  height: 0;
}

.ProseMirror h1 {
  font-size: 2.25rem;
  font-weight: 700;
  line-height: 1.2;
  margin-top: 2rem;
  margin-bottom: 1rem;
}

.ProseMirror h2 {
  font-size: 1.75rem;
  font-weight: 600;
  line-height: 1.3;
  margin-top: 1.75rem;
  margin-bottom: 0.75rem;
}

.ProseMirror h3 {
  font-size: 1.375rem;
  font-weight: 600;
  line-height: 1.4;
  margin-top: 1.5rem;
  margin-bottom: 0.5rem;
}

.ProseMirror p {
  margin-bottom: 1rem;
  line-height: 1.7;
}

.ProseMirror ul,
.ProseMirror ol {
  padding-left: 1.5rem;
  margin-bottom: 1rem;
}

.ProseMirror li {
  margin-bottom: 0.25rem;
}

.ProseMirror li p {
  margin-bottom: 0.25rem;
}

.ProseMirror blockquote {
  border-left: 4px solid #e5e7eb;
  padding-left: 1rem;
  margin: 1rem 0;
  color: #6b7280;
  font-style: italic;
}

.dark .ProseMirror blockquote {
  border-left-color: #374151;
  color: #9ca3af;
}

.ProseMirror hr {
  border: none;
  border-top: 2px solid #e5e7eb;
  margin: 2rem 0;
}

.dark .ProseMirror hr {
  border-top-color: #374151;
}

.ProseMirror code {
  background-color: #f3f4f6;
  padding: 0.125rem 0.375rem;
  border-radius: 0.25rem;
  font-family: var(--font-geist-mono), monospace;
  font-size: 0.875em;
}

.dark .ProseMirror code {
  background-color: #374151;
}

.ProseMirror pre {
  background-color: #0d1117;
  border-radius: 0.5rem;
  padding: 1rem;
  overflow-x: auto;
  border: 1px solid #27272a;
}

.dark .ProseMirror pre {
  background-color: #0d1117;
  border-color: #3f3f46;
}

.ProseMirror pre code {
  background: none !important;
  padding: 0;
  color: #c9d1d9;
  font-family: var(--font-geist-mono), monospace;
  font-size: 0.875rem;
  line-height: 1.7;
}

/* PDF.js viewer styles - minimal overrides for PDF.js internals */
.pdfjs-viewer .pdfViewer {
  min-height: 100%;
}

.pdfjs-viewer .page-container {
  margin: 20px auto;
  padding: 0 20px;
  box-sizing: content-box;
}

.pdfjs-viewer .page {
  box-sizing: content-box;
  margin: 20px auto;
  box-shadow: 0 0 8px #bbb;
  border: none;
}

.pdfjs-viewer .canvasWrapper > canvas,
.pdfjs-viewer div.pdf-canvas {
  background: #fff;
  box-shadow: 0 0 10px rgb(0 0 0 / 50%);
}

.pdfjs-viewer div.pdf-canvas.pdfng-empty,
.pdfjs-viewer div.pdf-canvas.pdfng-loading {
  background-color: #fff;
}

.pdfjs-viewer:focus-within {
  outline: none;
}

.pdfjs-viewer .textLayer,
.pdfjs-viewer .annotationLayer {
  will-change: transform;
}

.pdfjs-viewer .textLayer br::selection {
  background: transparent;
}

/* Syntax highlighting for ProseMirror code blocks (lowlight) */
.ProseMirror pre .hljs-keyword,
.ProseMirror pre .hljs-tag,
.ProseMirror pre .hljs-template-tag,
.ProseMirror pre .hljs-type {
  color: #ff7b72;
}

.ProseMirror pre .hljs-function,
.ProseMirror pre .hljs-title,
.ProseMirror pre .hljs-title.function_ {
  color: #d2a8ff;
}

.ProseMirror pre .hljs-string,
.ProseMirror pre .hljs-meta .hljs-string {
  color: #a5d6ff;
}

.ProseMirror pre .hljs-number,
.ProseMirror pre .hljs-literal,
.ProseMirror pre .hljs-variable,
.ProseMirror pre .hljs-attr {
  color: #79c0ff;
}

.ProseMirror pre .hljs-comment {
  color: #8b949e;
}

.ProseMirror pre .hljs-built_in,
.ProseMirror pre .hljs-symbol {
  color: #ffa657;
}

.ProseMirror pre .hljs-name,
.ProseMirror pre .hljs-selector-tag {
  color: #7ee787;
}

.ProseMirror pre .hljs-params {
  color: #c9d1d9;
}

.ProseMirror pre .hljs-property {
  color: #79c0ff;
}

.ProseMirror mark {
  background-color: #fef08a;
  padding: 0.125rem 0;
}

.dark .ProseMirror mark {
  background-color: #854d0e;
}

/* Table styles */
.ProseMirror table {
  border-collapse: collapse;
  table-layout: fixed;
  width: 100%;
  margin: 1rem 0;
  overflow: hidden;
}

.ProseMirror td,
.ProseMirror th {
  min-width: 1em;
  border: 1px solid #e4e4e7;
  padding: 0.5rem 0.75rem;
  vertical-align: top;
  box-sizing: border-box;
  position: relative;
}

.dark .ProseMirror td,
.dark .ProseMirror th {
  border-color: #3f3f46;
}

.ProseMirror th {
  background-color: #f4f4f5;
  font-weight: 600;
  text-align: left;
  color: #18181b;
}

.dark .ProseMirror th {
  background-color: #27272a;
  color: #fafafa;
}

.ProseMirror td {
  background-color: #ffffff;
}

.dark .ProseMirror td {
  background-color: #18181b;
}

.ProseMirror .selectedCell:after {
  z-index: 2;
  position: absolute;
  content: "";
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  background: rgba(59, 130, 246, 0.2);
  pointer-events: none;
}

/* Task list styles */
.ProseMirror ul[data-type="taskList"] {
  list-style: none;
  padding-left: 0;
  margin: 0;
}

.ProseMirror ul[data-type="taskList"] > li {
  display: flex;
  flex-direction: row;
  align-items: baseline;
  gap: 0.5rem;
  margin-bottom: 0.25rem;
}

.ProseMirror ul[data-type="taskList"] > li > label {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  user-select: none;
}

.ProseMirror ul[data-type="taskList"] > li > label input[type="checkbox"] {
  width: 1.125rem;
  height: 1.125rem;
  cursor: pointer;
  accent-color: #3b82f6;
  margin: 0;
}

.ProseMirror ul[data-type="taskList"] > li > div {
  flex: 1;
  display: inline;
}

.ProseMirror ul[data-type="taskList"] > li > div > p {
  margin: 0;
  display: inline;
}

.ProseMirror ul[data-type="taskList"] > li[data-checked="true"] > div {
  text-decoration: line-through;
  color: #9ca3af;
}

/* Image styles */
.ProseMirror img {
  max-width: 100%;
  height: auto;
  border-radius: 0.5rem;
  margin: 1rem 0;
}

.ProseMirror img.ProseMirror-selectednode {
  outline: 3px solid #3b82f6;
}

/* Link styles */
.ProseMirror a {
  color: #2563eb;
  text-decoration: underline;
  cursor: pointer;
}

.ProseMirror a:hover {
  color: #1d4ed8;
}

.dark .ProseMirror a {
  color: #60a5fa;
}

.dark .ProseMirror a:hover {
  color: #93c5fd;
}

/* Code block syntax highlighting */
pre code.hljs {
  display: block;
  overflow-x: auto;
  padding: 1em;
}

code.hljs {
  padding: 3px 5px;
}

.hljs {
  color: #24292e;
  background: #ffffff;
}

.hljs-doctag,
.hljs-keyword,
.hljs-meta .hljs-keyword,
.hljs-template-tag,
.hljs-template-variable,
.hljs-type,
.hljs-variable.language_ {
  color: #d73a49;
}

.hljs-title,
.hljs-title.class_,
.hljs-title.class_.inherited__,
.hljs-title.function_ {
  color: #6f42c1;
}

.hljs-attr,
.hljs-attribute,
.hljs-literal,
.hljs-meta,
.hljs-number,
.hljs-operator,
.hljs-selector-attr,
.hljs-selector-class,
.hljs-selector-id,
.hljs-variable {
  color: #005cc5;
}

.hljs-meta .hljs-string,
.hljs-regexp,
.hljs-string {
  color: #032f62;
}

.hljs-built_in,
.hljs-symbol {
  color: #e36209;
}

.hljs-code,
.hljs-comment,
.hljs-formula {
  color: #6a737d;
}

.hljs-name,
.hljs-quote,
.hljs-selector-pseudo,
.hljs-selector-tag {
  color: #22863a;
}

.hljs-subst {
  color: #24292e;
}

.hljs-section {
  color: #005cc5;
  font-weight: bold;
}

.hljs-bullet {
  color: #735c0f;
}

.hljs-emphasis {
  color: #24292e;
  font-style: italic;
}

.hljs-strong {
  color: #24292e;
  font-weight: bold;
}

.hljs-addition {
  color: #22863a;
  background-color: #f0fff4;
}

.hljs-deletion {
  color: #b31d28;
  background-color: #ffeef0;
}

/* Dark mode syntax highlighting */
@media (prefers-color-scheme: dark) {
  .hljs {
    color: #c9d1d9;
    background: #0d1117;
  }

  .hljs-doctag,
  .hljs-keyword,
  .hljs-meta .hljs-keyword,
  .hljs-template-tag,
  .hljs-template-variable,
  .hljs-type,
  .hljs-variable.language_ {
    color: #ff7b72;
  }

  .hljs-title,
  .hljs-title.class_,
  .hljs-title.class_.inherited__,
  .hljs-title.function_ {
    color: #d2a8ff;
  }

  .hljs-attr,
  .hljs-attribute,
  .hljs-literal,
  .hljs-meta,
  .hljs-number,
  .hljs-operator,
  .hljs-selector-attr,
  .hljs-selector-class,
  .hljs-selector-id,
  .hljs-variable {
    color: #79c0ff;
  }

  .hljs-meta .hljs-string,
  .hljs-regexp,
  .hljs-string {
    color: #a5d6ff;
  }

  .hljs-built_in,
  .hljs-symbol {
    color: #ffa657;
  }

  .hljs-code,
  .hljs-comment,
  .hljs-formula {
    color: #8b949e;
  }

  .hljs-name,
  .hljs-quote,
  .hljs-selector-pseudo,
  .hljs-selector-tag {
    color: #7ee787;
  }

  .hljs-subst {
    color: #c9d1d9;
  }

  .hljs-section {
    color: #79c0ff;
    font-weight: bold;
  }

  .hljs-bullet {
    color: #f2cc60;
  }

  .hljs-emphasis {
    color: #c9d1d9;
    font-style: italic;
  }

  .hljs-strong {
    color: #c9d1d9;
    font-weight: bold;
  }

  .hljs-addition {
    color: #aff5b4;
    background-color: #033a16;
  }

  .hljs-deletion {
    color: #ffdcd7;
    background-color: #67060c;
  }
}

/* Citation reference styles */
.cite-ref {
  color: #2563eb;
  font-weight: 500;
  cursor: pointer;
}

.cite-ref:hover {
  text-decoration: underline;
}

.dark .cite-ref {
  color: #60a5fa;
}

.figure-block {
  margin: 2rem auto;
  text-align: center;
  max-width: 100%;
}

.figure-block .figure-image {
  max-width: 100%;
  height: auto;
  border: 1px solid #e4e4e7;
  border-radius: 0.5rem;
  margin: 0 auto;
  display: block;
}

.dark .figure-block .figure-image {
  border-color: #3f3f46;
}

.figure-block .figure-caption {
  margin-top: 0.75rem;
  font-size: 0.875rem;
  color: #52525b;
  text-align: center;
}

.dark .figure-block .figure-caption {
  color: #a1a1aa;
}

/* Google Docs-style nested list - gray markers that cycle */
/* Marker colors - zinc-500 for light, zinc-400 for dark */
.prose ul > li::marker,
.prose ol > li::marker,
.ProseMirror ul > li::marker,
.ProseMirror ol > li::marker {
  color: #71717a; /* zinc-500 */
}

.dark .prose ul > li::marker,
.dark .prose ol > li::marker,
.dark .ProseMirror ul > li::marker,
.dark .ProseMirror ol > li::marker {
  color: #a1a1aa; /* zinc-400 */
}

/* Unordered list styles - cycle every 5 levels */
/* Level 1, 6, 11... : disc */
.prose ul,
.ProseMirror ul {
  list-style-type: disc;
}

/* Level 2, 7, 12... : circle */
.prose ul ul,
.prose ul ul ul ul ul ul,
.ProseMirror ul ul,
.ProseMirror ul ul ul ul ul ul {
  list-style-type: circle;
}

/* Level 3, 8, 13... : square */
.prose ul ul ul,
.prose ul ul ul ul ul ul ul,
.ProseMirror ul ul ul,
.ProseMirror ul ul ul ul ul ul ul {
  list-style-type: square;
}

/* Level 4, 9, 14... : disc (hollow appearance via circle) */
.prose ul ul ul ul,
.prose ul ul ul ul ul ul ul ul,
.ProseMirror ul ul ul ul,
.ProseMirror ul ul ul ul ul ul ul ul {
  list-style-type: disclosure-closed;
}

/* Level 5, 10, 15... : dash-like */
.prose ul ul ul ul ul,
.prose ul ul ul ul ul ul ul ul ul,
.ProseMirror ul ul ul ul ul,
.ProseMirror ul ul ul ul ul ul ul ul ul {
  list-style-type: "â€“  ";
}

/* Ordered list styles - cycle every 5 levels */
/* Level 1, 6... : 1, 2, 3 */
.prose ol,
.ProseMirror ol {
  list-style-type: decimal;
}

/* Level 2, 7... : a, b, c */
.prose ol ol,
.prose ol ol ol ol ol ol,
.ProseMirror ol ol,
.ProseMirror ol ol ol ol ol ol {
  list-style-type: lower-alpha;
}

/* Level 3, 8... : i, ii, iii */
.prose ol ol ol,
.prose ol ol ol ol ol ol ol,
.ProseMirror ol ol ol,
.ProseMirror ol ol ol ol ol ol ol {
  list-style-type: lower-roman;
}

/* Level 4, 9... : A, B, C */
.prose ol ol ol ol,
.prose ol ol ol ol ol ol ol ol,
.ProseMirror ol ol ol ol,
.ProseMirror ol ol ol ol ol ol ol ol {
  list-style-type: upper-alpha;
}

/* Level 5, 10... : I, II, III */
.prose ol ol ol ol ol,
.prose ol ol ol ol ol ol ol ol ol,
.ProseMirror ol ol ol ol ol,
.ProseMirror ol ol ol ol ol ol ol ol ol {
  list-style-type: upper-roman;
}

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

@keyframes slideStripe {
  0% {
    background-position: 0% 0%;
  }
  100% {
    background-position: 100% 100%;
  }
}
